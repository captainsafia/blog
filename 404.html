---
layout: default
title: "404: Page not found"
permalink: 404.html
---

<div class="page">
  <h1 class="page-title">404: Page not found</h1>
  <p class="lead">Sorry, we've misplaced that URL or it's pointing to something that doesn't exist. <a href="{{ site.baseurl }}">Head back home</a> to try finding it again.</p>
</div>

<script>
// Handle client-side redirects for common URL patterns that might not be caught server-side
(function() {
  const path = window.location.pathname;
  
  // Handle malformed OG image URLs
  if (path.includes('{"path"')) {
    window.location.href = '/';
    return;
  }
  
  // Handle .md files in URL
  if (path.endsWith('.md')) {
    window.location.href = '/';
    return;
  }
  
  // Handle query parameters with ref
  if (window.location.search.includes('ref=') || window.location.search.includes('utm_')) {
    // Remove query params and try the base path
    const cleanPath = path.replace(/\/$/, '') || '/';
    if (cleanPath !== path || window.location.search) {
      window.location.href = cleanPath;
      return;
    }
  }
  
  // Handle /brief page (redirect to main site)
  if (path === '/brief' || path === '/brief/') {
    window.location.href = 'https://safia.rocks';
    return;
  }
  
  // Handle paths with _posts directory (build artifacts)
  if (path.includes('/_posts/')) {
    window.location.href = '/';
    return;
  }
  
  // Handle nested date directories (e.g., /2025/10/13/2024/2024-05-27-...)
  const nestedDateMatch = path.match(/\/(\d{4})\/(\d{2})\/(\d{2})\/(\d{4})\/(\d{4}-\d{2}-\d{2}-.+)/);
  if (nestedDateMatch) {
    // Try to redirect to the correct post based on the second date
    const [, , , , year2, filename] = nestedDateMatch;
    const slug = filename.replace(/\.md$/, '').replace(/^\d{4}-\d{2}-\d{2}-/, '');
    window.location.href = '/archive';
    return;
  }
})();
</script>
